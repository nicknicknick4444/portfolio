<header>Diary</header>
{% extends "base.html" %}
{% load static %}
<meta name="viewport" content="width=device-width, initial-scale=1.0" />



{% block content %}


<a href="{% url "diary:new" %}">Add New Diary Entry</a>


{% if user.is_authenticated %}

 &nbsp;&nbsp;&nbsp;&nbsp;<a href="{% url "diary:set_time" %}">Adjust Send Time</a>

 &nbsp;&nbsp;&nbsp;&nbsp;<a href="{% url "logout" %}">Log Out</a>

{% else %}

 &nbsp;&nbsp;&nbsp;&nbsp;<a href="{% url "login" %}">Log In</a>

{% endif %}



<br>
<div class="page_contents">
Today is {{ today }}

{% if saved == "SAVED!" %}
 <p>
  User saved successfully!<br>
 </p>
{% endif %}

{% if searchu == "SEARCHING!" or searchu == "EMPTY!" and searchu != "CLEARED!" %}
 {% if word_query != "" %}
  <p>Searching for: {{ word_query }}</p>
 {% endif %}
 {% if user_query != None %}
  <p>Filtering by user: {{ user_query }}</p>
 {% endif %}
 {% if date_query != "" %}
  <p>Filtering by date: {{ date_query }}</p>
 {% endif %}
<!--<p></p>-->

{% endif %}

 <form action="{% url "diary:searchy" %}" method="POST" name="s" value="s">{% csrf_token %}
  <input type="text" name="term_search"></input>
  <!--<button type="submit">Search</button>--> Search: <br><br>

   
{% for the_user in users_list %}

  <label>{{ the_user.0 }}

{% comment %}
    {% if user_query == the_user.0 %}
     <input type="radio" name="sort_user", value="{{ query_name }}" checked>
    
     
    {% else %}
{% endcomment %}
     <input type="radio" name="sort_user" value="{{ the_user.0 }}">
  
  </label><br>

{% endfor %}

<br>

<label>Pick Date: 
 <input name="by_date" type="date">
</label>
<br><br>
 <button type="submit">Search & Filter</button>
</form>


</div>

	{% if searchu == "SEARCHING!" and searchu != "CLEARED!" %}
<div class="page_contents">
<button><a href="{% url "diary:clear_query" %}">Clear</a></button><br><br>
{{ searchu }}<br>
</div>
	{% endif %}


{% if searchu == "SEARCHING!" or searchu == "CLEARED!" or searchu == "USER_ADDED!" %}

<div class="page_contents"><br>


{% for find in object_listy %}

{% if find.is_old %}

<a href="{% url "diary:detail" find.pk %}">
<strong>{{ find.date_for }}<br>{{ find.title }}</strong><br>
{{ find.detail }}<br>
{{ find.user }}</a><br>
 <a href="{% url "diary:detail" find.pk %}">View Entry</a>
{% if user.is_authenticated %}
  |  
 <a href="{% url "diary:delete" find.pk %}">Delete Entry</a>


{% endif %}

<br><br>

{% else %}

<a href="{% url "diary:detail" find.pk %}">
<strong><i>{{ find.date_for }}</i><br>{{ find.title }}</strong><br>
{{ find.detail }}<br>
{{ find.user }}</a><br>
<a href="{% url "diary:detail" find.pk %}">View Entry</a><br>
{% if user.is_authenticated %}
 <a href="{% url "diary:edit" find.pk %}">Edit Entry</a>  |  
 <a href="{% url "diary:delete" find.pk %}">Delete Entry</a>

 
{% endif %}



<br><br>

{% endif %}

{% endfor %}

</div>

{% elif searchu == "EMPTY!" %}

<div class="page_contents">0 diary entries found.<br><br>
<button><a href="{% url "diary:clear_query" %}">Clear</a></button>
</div>


{% else %}


{% if messages %}
 {% for message in messages %}
 <strong>
 <div style="margin: auto; display: block; text-align: center;">
  {{ message }}
 </strong>
 </div>
 {% endfor %}
{% endif %}
<br>

<div class="listo" style="display: block; margin: auto; width: 90%; text-align: center;">
{% for entry in object_list %}

{% if entry.is_old %}

{% else %}

<a href="{% url "diary:detail" entry.pk %}">
<strong><i>{{ entry.date_for }}</i><br>
{{ entry.title }}</strong><br>
{{ entry.detail }}<br>
{{ entry.user }}</a><br>
<a href="{% url "diary:detail" entry.pk %}">View Entry</a><br> 
{% if user.is_authenticated %}
 <a href="{% url "diary:edit" entry.pk %}">Edit Entry</a>  |  
 <a href="{% url "diary:delete" entry.pk %}">Delete Entry</a>
<br><br>
{% else %}
<br>
{% endif %}



{% endif %}

{% endfor %}


{% endif %}


</div>

{% endblock content %}